import { addPublicationJsonLd } from '@starter-kit/utils/seo/addPublicationJsonLd';
import { getAutogeneratedPublicationOG } from '@starter-kit/utils/social/og';
import request from 'graphql-request';
import { GetStaticProps } from 'next';
import Head from 'next/head';
import Link from 'next/link';
import { 
	PublicationFragment,
	PostsByPublicationDocument,
	PostsByPublicationQuery,
	PostsByPublicationQueryVariables,
} from '../generated/graphql';
import { AppProvider } from '../components/contexts/appContext';
import ModernHeader from '../components/modern-header';
import { Footer } from '../components/footer';

const GQL_ENDPOINT = process.env.NEXT_PUBLIC_HASHNODE_GQL_ENDPOINT;

type Props = {
	publication: PublicationFragment;
};

export default function About({ publication }: Props) {
	return (
		<AppProvider publication={publication}>
			<Head>
				<title>About - {publication.displayTitle || publication.title}</title>
				<meta
					name="description"
					content="Learn more about John Schibelli, Senior Front-End Developer specializing in React, Next.js, TypeScript, and AI-driven development."
				/>
				<meta property="twitter:card" content="summary_large_image" />
				<meta property="twitter:title" content={`About - ${publication.displayTitle || publication.title}`} />
				<meta property="twitter:description" content="Learn more about John Schibelli, Senior Front-End Developer." />
				<meta property="twitter:image" content={getAutogeneratedPublicationOG(publication)} />
				<meta property="og:image" content={getAutogeneratedPublicationOG(publication)} />
				<meta property="og:image:width" content="1200" />
				<meta property="og:image:height" content="630" />
				<meta property="og:title" content={`About - ${publication.displayTitle || publication.title}`} />
				<meta property="og:description" content="Learn more about John Schibelli, Senior Front-End Developer." />
				<meta property="og:type" content="website" />
				<meta property="og:url" content={`${publication.url}/about`} />
				<link rel="canonical" href={`${publication.url}/about`} />
				<script
					type="application/ld+json"
					dangerouslySetInnerHTML={{
						__html: JSON.stringify(addPublicationJsonLd(publication)),
					}}
				/>
			</Head>

			<ModernHeader publication={publication} />

			<main className="min-h-screen bg-background">
				<div className="container mx-auto px-4 py-16">
					<div className="max-w-4xl mx-auto">
						<h1 className="text-4xl font-bold text-foreground mb-8">About John Schibelli</h1>
						
						<div className="prose prose-lg dark:prose-invert max-w-none">
							<p className="text-xl text-muted-foreground mb-8">
								Senior Front-End Developer with over 8 years of experience building modern web applications.
							</p>
							
							<h2 className="text-2xl font-semibold text-foreground mb-4">What I Do</h2>
							<p className="text-muted-foreground mb-6">
								I specialize in creating exceptional user experiences using React, Next.js, TypeScript, and modern web technologies. 
								My focus is on building scalable, performant applications that delight users and drive business results.
							</p>
							
							<h2 className="text-2xl font-semibold text-foreground mb-4">My Approach</h2>
							<p className="text-muted-foreground mb-6">
								I believe in writing clean, maintainable code and staying up-to-date with the latest industry best practices. 
								I&apos;m passionate about AI-driven development and finding innovative ways to improve the development workflow.
							</p>
							
							<h2 className="text-2xl font-semibold text-foreground mb-4">Let&apos;s Work Together</h2>
							<p className="text-muted-foreground mb-6">
								I&apos;m available for freelance projects and consulting opportunities. Whether you need a complete application 
								built from scratch or help optimizing an existing codebase, I&apos;d love to hear about your project.
							</p>
							
							<div className="mt-12 p-6 bg-muted rounded-lg">
								<h3 className="text-xl font-semibold text-foreground mb-4">Get In Touch</h3>
								<p className="text-muted-foreground mb-4">
									Ready to start your next project? Let&apos;s discuss how I can help bring your vision to life.
								</p>
								<Link 
									href="/contact" 
									className="inline-flex items-center px-6 py-3 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors"
								>
									Contact Me
								</Link>
							</div>
						</div>
					</div>
				</div>
			</main>

			<Footer />
		</AppProvider>
	);
}

export const getStaticProps: GetStaticProps<Props> = async () => {
	if (!GQL_ENDPOINT) {
		throw new Error('NEXT_PUBLIC_HASHNODE_GQL_ENDPOINT is not defined');
	}

	const data = await request<PostsByPublicationQuery, PostsByPublicationQueryVariables>(
		GQL_ENDPOINT,
		PostsByPublicationDocument,
		{
			first: 0,
			host: process.env.NEXT_PUBLIC_HASHNODE_PUBLICATION_HOST,
		},
	);

	const publication = data.publication;
	if (!publication) {
		return {
			notFound: true,
		};
	}

	return {
		props: {
			publication,
		},
		revalidate: 1,
	};
};
